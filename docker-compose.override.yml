services:

  ########################################################
  # Gradido ##############################################
  ########################################################
  gradido:
    image: gradido/gradido:local-development
    build:
      target: development
    networks:
      - external-net
      - internal-net
    environment:
      - NODE_ENV=development
    ulimits:
      nofile:
        soft: 200000
        hard: 400000
    volumes:
      # This makes sure the docker container has its own node modules.
      # Therefore it is possible to have a different node version on the host machine
      - node_modules:/app/node_modules
      - turbo_cache:/app/.turbo
      # bind the local folder to the docker to allow live reload
      - ./:/app

  #########################################################
  ## MARIADB ##############################################
  #########################################################
  mariadb:
    networks: 
      - internal-net
      - external-net

  #########################################################
  ## NGINX ################################################
  #########################################################
  # nginx:
  #########################################################
  ## PHPMYADMIN ###########################################
  #########################################################
  phpmyadmin:
    image: phpmyadmin
    environment:
     - PMA_ARBITRARY=1
    #restart: always
    ports:
     - 8074:80
    networks: 
     - internal-net
     - external-net
    volumes:
     - /sessions

  ########################################################
  # MAILSERVER TO FAKE SMTP ##############################
  ########################################################
  mailserver:
    image: maildev/maildev
    ports:
      - 1080:1080
      - 1025:1025
    networks:
      - external-net

volumes:
  node_modules:
  turbo_cache: